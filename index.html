<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Skills Transfer and Discovery for Sim-to-Real Learning: A Representation-Based Viewpoint">
  <meta name="keywords" content="STEADY, Sim-to-Real">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Offline Imitation Learning upon Arbitrary Demonstrations by Pre-Training Dynamics Representations </title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script> -->

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">
  <link rel="stylesheet" media="all" href="//fonts.googleapis.com/css?family=Lora:400,400i,700,700i">
  <link rel="stylesheet" media="all" href="//fonts.googleapis.com/css?family=Lexend">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
  <script type="text/javascript">
    window.MathJax = {
        tex: {
            macros: {
                rbr: ["\\left({#1}\\right)", 1],  // Bold italic text (1 argument)
                sbr: ["\\left[{#1}\\right]", 1],  // Bold italic text (1 argument)
                EE: "\\mathbb{E}",
                dpi: "d",
                boldit: ["\\boldsymbol{#1}", 1],  // Bold italic text (1 argument)
                vec: ["\\mathbf{#1}", 1],  // Bold vector notation (1 argument)
                st: "\\text{s.t.\ }",
                Pcal: "\\mathcal{P}",
                Scal: "\\mathcal{S}",
                Acal: "\\mathcal{A}"
            }
        }
    };
  </script> 
  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js">
  </script>
  <link rel="'icon" href="./static/images/favicon.svg">
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://scholar.harvard.edu/haitongma">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>
      
      <!-- <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://hypernerf.github.io">
            HyperNeRF
          </a>
          <a class="navbar-item" href="https://nerfies.github.io">
            Nerfies
          </a>
          <a class="navbar-item" href="https://latentfusion.github.io">
            LatentFusion
          </a>
          <a class="navbar-item" href="https://photoshape.github.io">
            PhotoShape
          </a>
        </div>
      </div> -->
    </div>

  </div>
</nav>


<section class="hero">
  <div class="hero-body">
    
    <div class="container is-max-desktop">
      <div class="colum is-centered">
        <div class="columns is-centered has-text-centered">
          <div>
          </div>
          <div class="column is-one-quarter">
            <div class="content has-text-justified">
              <img src="static/images/SEAS_Logo_RGB.png" alt="Harvard" style="vertical-align:middle;margin:10px 0px">
            </div>
          </div>
          <div class="column is-one-quarter">
            <div class="content has-text-justified">
              <img src="static/images/GeorgiaTech_RGB_0.png" alt="Georgia Tech">
            </div>
          </div>
          <div class="column is-one-quarter">
            <div class="content has-text-justified">
              <img src="static/images/merl.png" alt="MERL" style="vertical-align:middle;margin:20px 0px">
            </div>
          </div>
      </div>
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Offline Imitation Learning upon Arbitrary Demonstrations by Pre-Training Dynamics Representations  </h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://scholar.harvard.edu/haitongma">Haitong Ma</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://bo-dai.github.io/">Bo Dai</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://scholar.google.com/citations?user=n3j8fi0AAAAJ&hl=en">Zhaolin Ren</a><sup>1</sup>,</span>
              <span class="author-block">
                <a href="https://scholar.google.com/citations?user=n3j8fi0AAAAJ&hl=en">Yebin Wang</a><sup>3</sup>,</span>
              
            <span class="author-block">
              <a href="https://nali.seas.harvard.edu/">Na Li</a><sup>1</sup>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>Harvard Unviersity,</span>
            <span class="author-block"><sup>2</sup>Georgia Institute of Techology</span> <br>
            <span class="author-block"><sup>3</sup>Mitsubishi Electric Research Laboratories</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://scholar.harvard.edu/haitongma/files/repr-il-online-report.pdf"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <!-- <span class="link-block">
                <a href="https://arxiv.org/abs/2011.12948"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span> -->
              <!-- Video Link. -->
              <!-- <span class="link-block">
                <a href="https://www.youtube.com/watch?v=MrKrnHhk8IA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span> -->
              <!-- Code Link. -->
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code: to be published soon</span>
                  </a>
              </span>
              <!-- Dataset Link. -->
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- <section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <video id="teaser" autoplay muted loop playsinline height="100%">
        <source src="./static/videos/teaser.mp4"
                type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
        <span class="dnerf">Nerfies</span> turns selfie videos from your phone into
        free-viewpoint
        portraits.
      </h2>
    </div>
  </div>
</section> -->


<!-- <section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item item-steve">
          <video poster="" id="steve" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/steve.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-chair-tp">
          <video poster="" id="chair-tp" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/chair-tp.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-shiba">
          <video poster="" id="shiba" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/shiba.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-fullbody">
          <video poster="" id="fullbody" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/fullbody.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-blueshirt">
          <video poster="" id="blueshirt" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/blueshirt.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-mask">
          <video poster="" id="mask" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/mask.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-coffee">
          <video poster="" id="coffee" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/coffee.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-toby">
          <video poster="" id="toby" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/toby2.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>
    </div>
  </div>
</section> -->


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Limited data has become a major bottleneck in scaling up offline imitation learning (IL).
            In this paper, we propose enhancing IL performance under limited expert data by introducing a pre-training stage that learns <strong>dynamics representations</strong>, derived from factorizations of the transition dynamics. 
          </p>
          <p>
            We first theoretically justify that the optimal decision variable of offline IL lies in the representation space, significantly reducing the parameters to learn in the downstream IL. Moreover, 
            the dynamics representations can be learned from arbitrary data collected with the same dynamics, allowing the reuse of massive non-expert data and mitigating the limited data issues. 
          </p>
          
          <p>
            We present a tractable loss function inspired by noise contrastive estimation to learn the dynamics representations at the pre-training stage.
            Experiments on MuJoCo demonstrate that our proposed algorithm can mimic expert policies with as few as a single trajectory. 
            Experiments on real quadrupeds show that we can leverage pre-trained dynamics representations from simulator data to learn to walk from a few real-world demonstrations.
          </p>
            
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <!-- <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <div class="content has-text-justified">
          <h2 class="title is-8">1. Offline Imitation Learning</h2>
          <p>
            Consider MDP \(\mathcal{M} = \langle\Scal,\Acal,\rho,\gamma \rangle\) with state space \(\Scal\), action space \(\Acal\), initial distribution \(\rho\) and discounted factor \(\gamma\). 
            We consider offline IL using <strong>distribution matching</strong>, which is defined over the state-action visitation density,
            $$
            d^\pi(s):=(1-\gamma) \sum_{t=0}^{\infty} \gamma^t \operatorname{Pr}(s_t=s\mid s_0 \sim \rho,
            a_t \sim \pi\left(s_t\right), s_{t+1} \sim P\left(\cdot\mid s_t, a_t\right),\forall t).
            $$
          </p>
          <p>
            Assume we have an expert dataset \(\mathcal{D}^{\exp}\) sampled from distribution \(d^{\exp}:\Delta\rbr{\Scal}\times\Delta\rbr{\Acal}\)
          </p>

          We model the offline imitation learning as distribution matching problems,
          $$
          \begin{aligned}
          \min_{\pi, \dpi} &~  D_{f}\rbr{\dpi\| d^{\exp }}   = \EE_{(s, a)\sim d^{\exp}} \sbr{f\rbr{\frac{\dpi(s, a)}{d^{\exp}(s, a)}}}  \\ % \log\frac{\dpi(s)}{d^{\exp }(s)}
          % \text{s.t.} & ~ \text{reverse recursion constraints in \eqref{eq:dsa_recursion}}
          \st &~ \dpi\rbr{s', a'} = (1-\gamma) \rho\left(s'\right)\pi(a'| s')+\gamma\Pcal^\pi_* \dpi\rbr{s', a'}, \forall \rbr{s', a'}\in\Scal\times\Acal.
          \end{aligned} 
          $$
        </div>
      </div>
    </div> -->

    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Overview of the Imitation Learning Framework</h2>
        
      <div class="content has-text-centered">
        
        <p>
          <img src="static/images/demo.png" alt="repr-il structure">
        </p>
      </div>
      </div>
    </div>

    <!-- Paper video. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Implementations on the Unitree Go2 Quadrupeds</h2>
        <div class="publication-video">
          <iframe src="https://scholar.harvard.edu/sites/scholar.harvard.edu/files/haitongma/files/repr_il_video_v2.mp4"
                  frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
      </div>
    </div>
    <!-- <div class="columns is-centered has-text-centered">
      <h3 class="title is-3">Snapshots and Trajctories</h3>
    </div> -->
    <!-- <div class="columns is-centered has-text-centered">
      <div>
      </div>
      <div class="column is-one-quarter">
        <div class="content has-text-justified">
          <img src="static/images/blender_simulator.png">
          <div class="content has-text-centered">
            Simulator Controller
          </div>
        </div>
      </div>
      <div class="column is-one-quarter">
        <div class="content has-text-justified">
          <img src="static/images/blender-sim-to-real.png">
          <div class="content has-text-centered">
            Sim-to-Real Controller
          </div>
        </div>
      </div>
      <div class="column is-one-third">
        <div class="content has-text-justified">
          <img src="static/images/3dtraj_takeoff_proposal.png">
          <div class="content has-text-centered">
            3D Trajectories
          </div>
        </div>
      </div>
    </div> -->
    
    <!--/ Paper video. -->
    <!-- <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h3 class="title is-3">Video - Trajectory Tracking</h2>
        <div class="publication-video">
          <iframe src="https://scholar.harvard.edu/sites/scholar.harvard.edu/files/haitongma/files/figure_eight.mp4"
                  frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
      </div>
    </div> -->
  </div>
</div>

</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{ma2024skilltransfer,
  author    = {Ma, Haitong and Dai, Bo and Ren, Zhaolin and Wang, Yebin and Li, Na},
  title     = {Offline Imitation Learning upon Sub-optimal Demonstrations by Primal-Dual Representation},
  journal   = {technical report},
  year      = {2024},
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a> of this website,
            we just ask that you link back to this page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
